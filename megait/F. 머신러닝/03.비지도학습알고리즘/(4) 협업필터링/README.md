# 추천시스템 (Recommender System)

## #01. 추천시스템의 개요

대고객 대상으로 한 대부분의 플랫폼 서비스 업체들은 고객 개개인에게 맞춤형의 추천 서비스를 도입하고 있다.

> 전자상거래 업체, 유투브, 애플 뮤직 등

ML의 여러 알고리즘 중 비즈니스 관점에 부합하는 기법이 추천 시스템이다.

추천 시스템의 진정한 묘미는 사용자 본인도 모르는 취향 발견, 재구매로 연결하도록 설계되어 있다는 점임

### 추천시스템이 필요한 이유

모든 플랫폼 서비스는 기본적으로 추천서비스를 장착하고 싶어함

1. 플랫폼은 다수의 판매자와 소비자를 필요로 함, 문제는 카테고리와 메뉴구성이 복잡해지면 소비자의 제품 선택에 부작용
2. 만족도가 떨어지면 고객은 그 플랫폼을 떠날 가능성이 크며, 이는 플랫폼 서비스의 매출 하락과 직결됨

## #02. 추천시스템의 종류

### [1] Recommender System

유저에 대한 인구통계학(demographic)적인 정보를 이용

나이/성별/인종 등을 고려하여 인구통계학적 집단(demographic stereotype/cluster)을 정의해 둔 후, 타깃 유저를 이 중 한 집단으로 분류

비슷한 인구통계학적 특성을 보이는 사람들은 취향도 비슷할 것이라 가정하는 것

### [2] Content Filtering

유저가 아닌 아이템의 내용(contents)에 집중

영화를 예로 들면, 영화의 장르, 러닝타임, 감독, 주연 배우 등 영화에 대한 기본 정보를 활용함.

### [3] Collaborative Filtering

타깃 유저에 대한 데이터뿐만 아니라 다른 유저들에 대한 데이터도 적극적으로 활용

타깃 유저의 정보와 타 유저들의 정보가 협동(collaborate)하여 숨어있는 데이터를 찾아주는 방식

> 발전순으로 나열한 것이므로 지금은 Collaborative Filtering이 국룰~!!

## #03.  Surprise 패키지

### [1] 설치

sklearn 기반의 추천시스템 패키지

Windows에서 Surprise 패키지를 설치할 때는 MS Studio Build Tools 2015이상의 버전이 필요

pip 명령으로 `scikit-surprise` 패키지를 설치함

```shell
$ pip install scikit-surprise
```

설치 에러시 아래 명령을 수행한 후 다시 시도

```shell
$ pip install --upgrade pip setuptools wheel
```

### [2] 주요 알고리즘

| 클래스명 | 설명 |
|---|---|
| BaselineOnly | 사용자 Bias와 아이템 Bias를 고려한 SGD 베이스라인 알고리즘 |
| KNNBasic | 최근접 이웃 협업 필터링을 위한 KNN 알고리즘 |
| SVD | 행렬 분해를 통한 잠재 요인 협업 필터링을 위한 SVD 알고리즘<br/>Netflix Prize 기간 동안 Simon Funk 가 대중화함 |

### [3] 베이스라인 평점

개개인의 다양한 평가성향을 반영해 아이템 평가에 편향성(bias) 요소를 반영하여 평점을 부과하는 것을 베이스라인 평점(Baseline Rating)이라고 한다.

$$베이스라인 평점 = 전체 평균 평점 + 사용자 편향 점 + 아이템 편향 점수$$
 
| 항목 | 내용 |
|---|---|
| 전체 평균 평점 | 모든 사용자의 아이템에 대한 평점의 평균 |
| 사용자 편향 점수 | 사용자별 아이템 평점 평균 값 - 전체 평균 평점 |
| 아이템 편향 점수 | 아이템별 평점 평균 값 - 전체 평균 평점 |

예로 들어, 모든 사용자의 평균적인 영화 평점이 `3.5`이고, '어벤저스 3편'을 모든 사용자가 평균적으로 평점 `4.2`로 평가했다면 영화 평가를 늘 까다롭게 평가하여 평균 평점이 `3.0`인 사용자 A가 '어벤저스 3편'을 어떻게 평가할 것인지 예측

사용자 편향 점수는 $3.0 - 3.5 = -0.5$ 이고, 아이템 편향 점수는 $4.2 - 3.5 = 0.7$로 계산할 수 있다. 

따라서 사용자 A의 '어벤저스 3편'의 베이스라인 평점은 $3.5 - 0.5 + 0.7 = 3.7$ 이다.
